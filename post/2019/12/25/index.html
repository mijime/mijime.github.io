<!DOCTYPE html><html lang="ja"><head><link rel="icon" href="/favicon.png"/><meta name="google-site-verification" content="7gVj5rzyozu0vYcQMLhIGr4g-WWyJn4R22RgeYqQdS0"/><script src="https://www.googletagmanager.com/gtag/js?id=UA-46554348-4"></script><script>
window.dataLayer = window.dataLayer || [];
window.gtag = function(){dataLayer.push(arguments);}
window.gtag('js', new Date());
window.gtag('config', 'UA-46554348-4', {page_path: window.location.pathname});
</script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>macOSからChromeOSに移行したけど、いろいろ辛かった | My snippets</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/3118f4a5cdc48aa468ba.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3118f4a5cdc48aa468ba.css" data-n-g=""/><link rel="preload" href="/_next/static/css/be10f5f7efdee9258153.css" as="style"/><link rel="stylesheet" href="/_next/static/css/be10f5f7efdee9258153.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-377d9957422d331503bc.js" defer=""></script><script src="/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/_next/static/chunks/main-ff11dfa7b9d2932d51f3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-aeb6e3be34fe6d240b38.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5B...paths%5D-9248b9a62a3194e493a0.js" defer=""></script><script src="/_next/static/1cM0zPcXCmvgNJ12n612E/_buildManifest.js" defer=""></script><script src="/_next/static/1cM0zPcXCmvgNJ12n612E/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="default_defaultLayout__1hsFy"><section class="navbar-header_navbarHeader__3g5tB"><h3 class="navbar-header_navbarHeaderTitle__2ef7R"><a href="/">My snippets</a></h3></section><div class="default_defaultLayoutContent__2tmRG"><div class="card_card__DcOjB"><h1 class="article-card_title__3J6E6"><a href="/post/2019/12/25/">macOSからChromeOSに移行したけど、いろいろ辛かった</a></h1><div class="tag-list_tagList__2paiH"><span class="tag_tag__Z47f9 tag-list_tagLink__ESpk3"><a href="/tag/development/posts/1/">development</a></span><span class="tag_tag__Z47f9 tag-list_tagDate__2WCFH">a year ago</span></div><div class="article-card_content__3af8_"><div class="prose prose_prose__2WXno"><p>初めての ChromeOS だったのでいろいろハマった</p><h2>標準ターミナルで日本語打つとぶっ壊れる</h2><p>そもそも標準ターミナルで日本語の切り替え方がわからずにハマった。</p><ul><li><a href="https://chromium.googlesource.com/apps/libapps/+/master/hterm/doc/KeyboardBindings.md">https://chromium.googlesource.com/apps/libapps/+/master/hterm/doc/KeyboardBindings.md</a></li></ul><p>Secure Shell app のほうの keybidings で<code>Ctrl-Space</code>を送信できれば解決できた。</p><p>fcitx で解決、みたいな記事をよくみかけたけど、自分は解決できなかった。</p><p>下記の設定を keybindings にいれた。</p><pre><code>{
    &quot;keybindings&quot;: {
        &quot;Ctrl-Space&quot;: &quot;DEFAULT&quot;
    }
}
</code></pre><p>ただ、実際に日本語で送信してみると、補完入力とターミナルのバッファが
ごっちゃになっているように見える。
補完の内容がバッファに残ったままだったり、tmux の window-size がおかしくなったりと辛い。</p><p>vim 内であれば Ctrl-L でリセットできる。日本語入力中は辛いが。</p><h2>Alacritty で絵文字表示されない</h2><p>上の問題があって、Terminal を Alacritty + fcitx を採用したけど、ここでも問題があった。</p><p>デフォルトだと WAYLAND?の設定が良くないらしく、fcitx が立ち上がらなかったり、
全画面起動ができなかった。</p><p>WAYLAND を空白で起動すれば解決した。
毎回ターミナルから alacritty を立ち上げるのは嫌なので alacritty.desktop を用意した。</p><pre><code>[Desktop Entry]
Type=Application
TryExec=alacritty
Exec=env WAYLAND_DISPLAY= alacritty
Icon=Alacritty
Terminal=false
Categories=System;TerminalEmulator;

Name=Alacritty
GenericName=Terminal
Comment=A cross-platform, GPU enhanced terminal emulator
StartupWMClass=Alacritty
Actions=New;

[Desktop Action New]
Name=New Terminal
Exec=env WAYLAND_DISPLAY= alacritty
</code></pre><p>fcitx 自体は立ち上がるようになったけど、今度は絵文字がうまく表示されず。</p><p>Alacritty 自体に同様の Issue が結構上がっていて、MacOS の絵文字はうまくいくんだけど。。みたいな内容で終わっていたように見える。</p><p>カラフルな絵文字は諦めたが、さすがに空白だと辛いので <code>twemoji-color-font</code> を入れて
starship に設定していた絵文字は全部表示できるようにした。</p><h2>音楽が再生できない</h2><p>mpv を入れたけど、今度はターミナルから音楽がならない。
コンテナを<code>--enable-audio-capture</code>して起動しないといけないらしい。</p><ul><li><a href="https://chromium.googlesource.com/chromiumos/docs/+/master/containers_and_vms.md#is-audio-capture-e_g_microphone_supported">https://chromium.googlesource.com/chromiumos/docs/+/master/containers_and_vms.md#is-audio-capture-e_g_microphone_supported</a></li></ul><p>crosh 上で</p><pre><code>vmc stop termina
vmc start termina --enable-audio-capture
</code></pre><p>すれば解決した。</p><p>その後、Alacritty が透過できない+画面最大化できない、という症状になったけど
これは <code>Logout-&gt;Login</code> で治った。</p><p>思ったより、音楽を鳴らすのに CPU を使っているけど。。pluse なんぞや。。</p></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"siteName":"My snippets","source":{"compiledSource":"var s=Object.defineProperty,d=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;var c=(e,p,t)=\u003ep in e?s(e,p,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[p]=t,r=(e,p)=\u003e{for(var t in p||(p={}))i.call(p,t)\u0026\u0026c(e,t,p[t]);if(o)for(var t of o(p))n.call(p,t)\u0026\u0026c(e,t,p[t]);return e},m=(e,p)=\u003ed(e,u(p));var l=(e,p)=\u003e{var t={};for(var a in e)i.call(e,a)\u0026\u0026p.indexOf(a)\u003c0\u0026\u0026(t[a]=e[a]);if(e!=null\u0026\u0026o)for(var a of o(e))p.indexOf(a)\u003c0\u0026\u0026n.call(e,a)\u0026\u0026(t[a]=e[a]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var a=t,{components:e}=a,p=l(a,[\"components\"]);return mdx(MDXLayout,m(r(r({},layoutProps),p),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"\\u521D\\u3081\\u3066\\u306E ChromeOS \\u3060\\u3063\\u305F\\u306E\\u3067\\u3044\\u308D\\u3044\\u308D\\u30CF\\u30DE\\u3063\\u305F\"),mdx(\"h2\",null,\"\\u6A19\\u6E96\\u30BF\\u30FC\\u30DF\\u30CA\\u30EB\\u3067\\u65E5\\u672C\\u8A9E\\u6253\\u3064\\u3068\\u3076\\u3063\\u58CA\\u308C\\u308B\"),mdx(\"p\",null,\"\\u305D\\u3082\\u305D\\u3082\\u6A19\\u6E96\\u30BF\\u30FC\\u30DF\\u30CA\\u30EB\\u3067\\u65E5\\u672C\\u8A9E\\u306E\\u5207\\u308A\\u66FF\\u3048\\u65B9\\u304C\\u308F\\u304B\\u3089\\u305A\\u306B\\u30CF\\u30DE\\u3063\\u305F\\u3002\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",r({parentName:\"li\"},{href:\"https://chromium.googlesource.com/apps/libapps/+/master/hterm/doc/KeyboardBindings.md\"}),\"https://chromium.googlesource.com/apps/libapps/+/master/hterm/doc/KeyboardBindings.md\"))),mdx(\"p\",null,\"Secure Shell app \\u306E\\u307B\\u3046\\u306E keybidings \\u3067\",mdx(\"inlineCode\",{parentName:\"p\"},\"Ctrl-Space\"),\"\\u3092\\u9001\\u4FE1\\u3067\\u304D\\u308C\\u3070\\u89E3\\u6C7A\\u3067\\u304D\\u305F\\u3002\"),mdx(\"p\",null,\"fcitx \\u3067\\u89E3\\u6C7A\\u3001\\u307F\\u305F\\u3044\\u306A\\u8A18\\u4E8B\\u3092\\u3088\\u304F\\u307F\\u304B\\u3051\\u305F\\u3051\\u3069\\u3001\\u81EA\\u5206\\u306F\\u89E3\\u6C7A\\u3067\\u304D\\u306A\\u304B\\u3063\\u305F\\u3002\"),mdx(\"p\",null,\"\\u4E0B\\u8A18\\u306E\\u8A2D\\u5B9A\\u3092 keybindings \\u306B\\u3044\\u308C\\u305F\\u3002\"),mdx(\"pre\",null,mdx(\"code\",r({parentName:\"pre\"},{}),`{\n    \"keybindings\": {\n        \"Ctrl-Space\": \"DEFAULT\"\n    }\n}\n`)),mdx(\"p\",null,`\\u305F\\u3060\\u3001\\u5B9F\\u969B\\u306B\\u65E5\\u672C\\u8A9E\\u3067\\u9001\\u4FE1\\u3057\\u3066\\u307F\\u308B\\u3068\\u3001\\u88DC\\u5B8C\\u5165\\u529B\\u3068\\u30BF\\u30FC\\u30DF\\u30CA\\u30EB\\u306E\\u30D0\\u30C3\\u30D5\\u30A1\\u304C\n\\u3054\\u3063\\u3061\\u3083\\u306B\\u306A\\u3063\\u3066\\u3044\\u308B\\u3088\\u3046\\u306B\\u898B\\u3048\\u308B\\u3002\n\\u88DC\\u5B8C\\u306E\\u5185\\u5BB9\\u304C\\u30D0\\u30C3\\u30D5\\u30A1\\u306B\\u6B8B\\u3063\\u305F\\u307E\\u307E\\u3060\\u3063\\u305F\\u308A\\u3001tmux \\u306E window-size \\u304C\\u304A\\u304B\\u3057\\u304F\\u306A\\u3063\\u305F\\u308A\\u3068\\u8F9B\\u3044\\u3002`),mdx(\"p\",null,\"vim \\u5185\\u3067\\u3042\\u308C\\u3070 Ctrl-L \\u3067\\u30EA\\u30BB\\u30C3\\u30C8\\u3067\\u304D\\u308B\\u3002\\u65E5\\u672C\\u8A9E\\u5165\\u529B\\u4E2D\\u306F\\u8F9B\\u3044\\u304C\\u3002\"),mdx(\"h2\",null,\"Alacritty \\u3067\\u7D75\\u6587\\u5B57\\u8868\\u793A\\u3055\\u308C\\u306A\\u3044\"),mdx(\"p\",null,\"\\u4E0A\\u306E\\u554F\\u984C\\u304C\\u3042\\u3063\\u3066\\u3001Terminal \\u3092 Alacritty + fcitx \\u3092\\u63A1\\u7528\\u3057\\u305F\\u3051\\u3069\\u3001\\u3053\\u3053\\u3067\\u3082\\u554F\\u984C\\u304C\\u3042\\u3063\\u305F\\u3002\"),mdx(\"p\",null,`\\u30C7\\u30D5\\u30A9\\u30EB\\u30C8\\u3060\\u3068 WAYLAND?\\u306E\\u8A2D\\u5B9A\\u304C\\u826F\\u304F\\u306A\\u3044\\u3089\\u3057\\u304F\\u3001fcitx \\u304C\\u7ACB\\u3061\\u4E0A\\u304C\\u3089\\u306A\\u304B\\u3063\\u305F\\u308A\\u3001\n\\u5168\\u753B\\u9762\\u8D77\\u52D5\\u304C\\u3067\\u304D\\u306A\\u304B\\u3063\\u305F\\u3002`),mdx(\"p\",null,`WAYLAND \\u3092\\u7A7A\\u767D\\u3067\\u8D77\\u52D5\\u3059\\u308C\\u3070\\u89E3\\u6C7A\\u3057\\u305F\\u3002\n\\u6BCE\\u56DE\\u30BF\\u30FC\\u30DF\\u30CA\\u30EB\\u304B\\u3089 alacritty \\u3092\\u7ACB\\u3061\\u4E0A\\u3052\\u308B\\u306E\\u306F\\u5ACC\\u306A\\u306E\\u3067 alacritty.desktop \\u3092\\u7528\\u610F\\u3057\\u305F\\u3002`),mdx(\"pre\",null,mdx(\"code\",r({parentName:\"pre\"},{}),`[Desktop Entry]\nType=Application\nTryExec=alacritty\nExec=env WAYLAND_DISPLAY= alacritty\nIcon=Alacritty\nTerminal=false\nCategories=System;TerminalEmulator;\n\nName=Alacritty\nGenericName=Terminal\nComment=A cross-platform, GPU enhanced terminal emulator\nStartupWMClass=Alacritty\nActions=New;\n\n[Desktop Action New]\nName=New Terminal\nExec=env WAYLAND_DISPLAY= alacritty\n`)),mdx(\"p\",null,\"fcitx \\u81EA\\u4F53\\u306F\\u7ACB\\u3061\\u4E0A\\u304C\\u308B\\u3088\\u3046\\u306B\\u306A\\u3063\\u305F\\u3051\\u3069\\u3001\\u4ECA\\u5EA6\\u306F\\u7D75\\u6587\\u5B57\\u304C\\u3046\\u307E\\u304F\\u8868\\u793A\\u3055\\u308C\\u305A\\u3002\"),mdx(\"p\",null,\"Alacritty \\u81EA\\u4F53\\u306B\\u540C\\u69D8\\u306E Issue \\u304C\\u7D50\\u69CB\\u4E0A\\u304C\\u3063\\u3066\\u3044\\u3066\\u3001MacOS \\u306E\\u7D75\\u6587\\u5B57\\u306F\\u3046\\u307E\\u304F\\u3044\\u304F\\u3093\\u3060\\u3051\\u3069\\u3002\\u3002\\u307F\\u305F\\u3044\\u306A\\u5185\\u5BB9\\u3067\\u7D42\\u308F\\u3063\\u3066\\u3044\\u305F\\u3088\\u3046\\u306B\\u898B\\u3048\\u308B\\u3002\"),mdx(\"p\",null,\"\\u30AB\\u30E9\\u30D5\\u30EB\\u306A\\u7D75\\u6587\\u5B57\\u306F\\u8AE6\\u3081\\u305F\\u304C\\u3001\\u3055\\u3059\\u304C\\u306B\\u7A7A\\u767D\\u3060\\u3068\\u8F9B\\u3044\\u306E\\u3067 \",mdx(\"inlineCode\",{parentName:\"p\"},\"twemoji-color-font\"),` \\u3092\\u5165\\u308C\\u3066\nstarship \\u306B\\u8A2D\\u5B9A\\u3057\\u3066\\u3044\\u305F\\u7D75\\u6587\\u5B57\\u306F\\u5168\\u90E8\\u8868\\u793A\\u3067\\u304D\\u308B\\u3088\\u3046\\u306B\\u3057\\u305F\\u3002`),mdx(\"h2\",null,\"\\u97F3\\u697D\\u304C\\u518D\\u751F\\u3067\\u304D\\u306A\\u3044\"),mdx(\"p\",null,`mpv \\u3092\\u5165\\u308C\\u305F\\u3051\\u3069\\u3001\\u4ECA\\u5EA6\\u306F\\u30BF\\u30FC\\u30DF\\u30CA\\u30EB\\u304B\\u3089\\u97F3\\u697D\\u304C\\u306A\\u3089\\u306A\\u3044\\u3002\n\\u30B3\\u30F3\\u30C6\\u30CA\\u3092`,mdx(\"inlineCode\",{parentName:\"p\"},\"--enable-audio-capture\"),\"\\u3057\\u3066\\u8D77\\u52D5\\u3057\\u306A\\u3044\\u3068\\u3044\\u3051\\u306A\\u3044\\u3089\\u3057\\u3044\\u3002\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",r({parentName:\"li\"},{href:\"https://chromium.googlesource.com/chromiumos/docs/+/master/containers_and_vms.md#is-audio-capture-e_g_microphone_supported\"}),\"https://chromium.googlesource.com/chromiumos/docs/+/master/containers_and_vms.md#is-audio-capture-e_g_microphone_supported\"))),mdx(\"p\",null,\"crosh \\u4E0A\\u3067\"),mdx(\"pre\",null,mdx(\"code\",r({parentName:\"pre\"},{}),`vmc stop termina\nvmc start termina --enable-audio-capture\n`)),mdx(\"p\",null,\"\\u3059\\u308C\\u3070\\u89E3\\u6C7A\\u3057\\u305F\\u3002\"),mdx(\"p\",null,`\\u305D\\u306E\\u5F8C\\u3001Alacritty \\u304C\\u900F\\u904E\\u3067\\u304D\\u306A\\u3044+\\u753B\\u9762\\u6700\\u5927\\u5316\\u3067\\u304D\\u306A\\u3044\\u3001\\u3068\\u3044\\u3046\\u75C7\\u72B6\\u306B\\u306A\\u3063\\u305F\\u3051\\u3069\n\\u3053\\u308C\\u306F `,mdx(\"inlineCode\",{parentName:\"p\"},\"Logout-\u003eLogin\"),\" \\u3067\\u6CBB\\u3063\\u305F\\u3002\"),mdx(\"p\",null,\"\\u601D\\u3063\\u305F\\u3088\\u308A\\u3001\\u97F3\\u697D\\u3092\\u9CF4\\u3089\\u3059\\u306E\\u306B CPU \\u3092\\u4F7F\\u3063\\u3066\\u3044\\u308B\\u3051\\u3069\\u3002\\u3002pluse \\u306A\\u3093\\u305E\\u3084\\u3002\\u3002\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"post":{"title":"macOSからChromeOSに移行したけど、いろいろ辛かった","description":"\n初めての ChromeOS だったのでいろいろハマった\n\n\u003c!--more--\u003e\n\n## 標準ターミナルで日本語打つとぶっ壊れる\n\nそもそも標準ターミナルで日本語の切り替え方がわからずにハマった。\n","createdAt":"2019-12-24T16:23:33.000Z","tags":["development"],"draft":false,"slug":"2019/12/25","content":"\n初めての ChromeOS だったのでいろいろハマった\n\n\u003c!--more--\u003e\n\n## 標準ターミナルで日本語打つとぶっ壊れる\n\nそもそも標準ターミナルで日本語の切り替え方がわからずにハマった。\n\n- https://chromium.googlesource.com/apps/libapps/+/master/hterm/doc/KeyboardBindings.md\n\nSecure Shell app のほうの keybidings で`Ctrl-Space`を送信できれば解決できた。\n\nfcitx で解決、みたいな記事をよくみかけたけど、自分は解決できなかった。\n\n下記の設定を keybindings にいれた。\n\n```\n{\n    \"keybindings\": {\n        \"Ctrl-Space\": \"DEFAULT\"\n    }\n}\n```\n\nただ、実際に日本語で送信してみると、補完入力とターミナルのバッファが\nごっちゃになっているように見える。\n補完の内容がバッファに残ったままだったり、tmux の window-size がおかしくなったりと辛い。\n\nvim 内であれば Ctrl-L でリセットできる。日本語入力中は辛いが。\n\n## Alacritty で絵文字表示されない\n\n上の問題があって、Terminal を Alacritty + fcitx を採用したけど、ここでも問題があった。\n\nデフォルトだと WAYLAND?の設定が良くないらしく、fcitx が立ち上がらなかったり、\n全画面起動ができなかった。\n\nWAYLAND を空白で起動すれば解決した。\n毎回ターミナルから alacritty を立ち上げるのは嫌なので alacritty.desktop を用意した。\n\n```\n[Desktop Entry]\nType=Application\nTryExec=alacritty\nExec=env WAYLAND_DISPLAY= alacritty\nIcon=Alacritty\nTerminal=false\nCategories=System;TerminalEmulator;\n\nName=Alacritty\nGenericName=Terminal\nComment=A cross-platform, GPU enhanced terminal emulator\nStartupWMClass=Alacritty\nActions=New;\n\n[Desktop Action New]\nName=New Terminal\nExec=env WAYLAND_DISPLAY= alacritty\n```\n\nfcitx 自体は立ち上がるようになったけど、今度は絵文字がうまく表示されず。\n\nAlacritty 自体に同様の Issue が結構上がっていて、MacOS の絵文字はうまくいくんだけど。。みたいな内容で終わっていたように見える。\n\nカラフルな絵文字は諦めたが、さすがに空白だと辛いので `twemoji-color-font` を入れて\nstarship に設定していた絵文字は全部表示できるようにした。\n\n## 音楽が再生できない\n\nmpv を入れたけど、今度はターミナルから音楽がならない。\nコンテナを`--enable-audio-capture`して起動しないといけないらしい。\n\n- https://chromium.googlesource.com/chromiumos/docs/+/master/containers_and_vms.md#is-audio-capture-e_g_microphone_supported\n\ncrosh 上で\n\n```\nvmc stop termina\nvmc start termina --enable-audio-capture\n```\n\nすれば解決した。\n\nその後、Alacritty が透過できない+画面最大化できない、という症状になったけど\nこれは `Logout-\u003eLogin` で治った。\n\n思ったより、音楽を鳴らすのに CPU を使っているけど。。pluse なんぞや。。\n"}},"__N_SSG":true},"page":"/post/[...paths]","query":{"paths":["2019","12","25"]},"buildId":"1cM0zPcXCmvgNJ12n612E","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>