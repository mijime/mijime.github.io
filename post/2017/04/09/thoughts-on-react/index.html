<!DOCTYPE html><html lang="ja"><head><link rel="icon" href="/favicon.png"/><meta name="google-site-verification" content="7gVj5rzyozu0vYcQMLhIGr4g-WWyJn4R22RgeYqQdS0"/><script src="https://www.googletagmanager.com/gtag/js?id=UA-46554348-4"></script><script>
window.dataLayer = window.dataLayer || [];
window.gtag = function(){dataLayer.push(arguments);}
window.gtag('js', new Date());
window.gtag('config', 'UA-46554348-4', {page_path: window.location.pathname});
</script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>ReactでMarkdownEditorを作ったかんそう | My snippets</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/3118f4a5cdc48aa468ba.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3118f4a5cdc48aa468ba.css" data-n-g=""/><link rel="preload" href="/_next/static/css/be10f5f7efdee9258153.css" as="style"/><link rel="stylesheet" href="/_next/static/css/be10f5f7efdee9258153.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-377d9957422d331503bc.js" defer=""></script><script src="/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/_next/static/chunks/main-ff11dfa7b9d2932d51f3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-aeb6e3be34fe6d240b38.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5B...paths%5D-9248b9a62a3194e493a0.js" defer=""></script><script src="/_next/static/AnNfzTuH3AQR6W_HWvg1c/_buildManifest.js" defer=""></script><script src="/_next/static/AnNfzTuH3AQR6W_HWvg1c/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="default_defaultLayout__1hsFy"><section class="navbar-header_navbarHeader__3g5tB"><h3 class="navbar-header_navbarHeaderTitle__2ef7R"><a href="/">My snippets</a></h3></section><div class="default_defaultLayoutContent__2tmRG"><div class="card_card__DcOjB"><h1 class="article-card_title__3J6E6"><a href="/post/2017/04/09/thoughts-on-react/">ReactでMarkdownEditorを作ったかんそう</a></h1><div class="tag-list_tagList__2paiH"><span class="tag_tag__Z47f9 tag-list_tagLink__ESpk3"><a href="/tag/development/posts/1/">development</a></span><span class="tag_tag__Z47f9 tag-list_tagLink__ESpk3"><a href="/tag/react/posts/1/">react</a></span><span class="tag_tag__Z47f9 tag-list_tagDate__2WCFH">4 years ago</span></div><div class="article-card_content__3af8_"><div class="prose prose_prose__2WXno"><h2>作ったもの</h2><p><a href="https://github.com/mijime/markdown-editor">https://github.com/mijime/markdown-editor</a></p><p>ダウンロードすればオフラインでも使えるマークダウンエディタを作りたかった</p><hr/><h2>使ってよかったもの</h2><h2>Rehype, Remark</h2><ul><li><a href="https://github.com/wooorm/rehype">https://github.com/wooorm/rehype</a></li><li><a href="https://github.com/wooorm/remark">https://github.com/wooorm/remark</a></li></ul><p>HTML や Markdown を AST に変換してくれる。</p><p>Marked が String を既にがっちゃんこ状態で投げてくるので
dangerouslySetInnerHTML を使わざるえない影響が出てくる。</p><p>そういうときは上の Rehype, Remark で AST に変換してから React コンポーネントにするアプローチが良さげ。</p><p>react-markdown ていうのもあったけど commonmark に準拠してるらしく、テーブルの変換ができなかったので諦めた。
あと commonmark が割と容量食ってたのもある。</p><p>remark-react を使わなかったのは highlight 系のライブラリをかます必要があったのと
<code>markdown -&gt; html -&gt; react</code> の流れのほうが拡張しやすく感じた。
絵文字対応もさくっといけたし。</p><p>なんかやるとき、もしくはデンジャラスなコードを強要されたときはまた使ってみたい。</p><p>ただ、 marked の方が軽量ではあったので、1 回きりの表示なら marked のほうが断然良さそう。</p><h2>Prism.js</h2><ul><li><a href="http://prismjs.com/">http://prismjs.com/</a></li></ul><p>highlight.js を Minify すると中身が飛びでて辛いときに使ったやつ。</p><p>プロセッサも分かれてるのでそのまま rehype に流せた。</p><p>プラッガブルでなかなかに軽量なので、おすすめしていきたい。</p><h2>Preact</h2><ul><li><a href="https://preactjs.com/">https://preactjs.com/</a></li></ul><p>React がでかすぎたので使って見た。</p><p>webpack-bundle-size-anlyzer をつかってサイズを比較した。</p><p>ReactDOM + React が 500+kb なのに対し、 Preact + Preact-compat が 35kb 前後？良い。</p><p>React-Redux は普通に使えたので、 問題はなかった。 React-helmet とか React-router 周りはまだ試していない。
ただ、Preact-helmet や Preact-router とかあるし、なんだかんだでまた使えそう。</p><p>dio.js とかも同様も簡単に乗り換えられるか試したけど、 Preact-compat はだいぶ頑張っているのが分かっただけだった。</p><p>Jest や StyleGuidist なんかが React を強要するので、 Webpack でビルド時のみ差し替える運用にした。</p><h2>milligram</h2><ul><li><a href="https://milligram.github.io/">https://milligram.github.io/</a></li></ul><p>マークダウンプレビューとしては綺麗に表示できるので、
みんな Github.css から乗り換えるべきだと思う。軽量ですし。</p><p>ただ、シンプルなコンポーネントしかないので
UI が複雑になってきたなら Material なんちゃら系の方が良さそう、とは思う</p><hr/><h2>見送ったもの</h2><h2>highlight.js</h2><p>みんな言語絞って使ってるくさい。最初、何度圧縮してもクソでかくて不思議だった。
言語によっては圧縮時に飛び出る。 と思ったけど browserify 使った時は問題なさそう。. だった？</p><p>使うのやめた。</p><h2>CodeMirror</h2><p>重量がなかなかあったので、採用を見送った。 vim mode 試したかった。</p><p>もっと軽量なエディタがあれば選択肢に入れたかったので、あとで探す。</p><hr/><h2>React.setState</h2><p>React の setState は使わずに pure component だけで構成したかったので。</p><p>非同期に描画してコンポーネント内だけで完結するなら、 state を使って書いた方が切り出しやすかった。</p><h2>Flow</h2><p>今回は頑張って Flowtype に立ち向かってみた。 Flow-jsdoc で JSDoc と同期をとりつつ、みたいなことを実現したかったが、
type 周りが対応してなかったので結局 flow-comment をちりばめながら書くはめになった。</p><p>あと、flow さんって commonjs スタイル読み取ってくれないのが一番のショックだった。
その他にも、他のライブラリの <!-- -->*<!-- -->.flow にビンビン反応していくのもちょいちょい辛い。</p></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"siteName":"My snippets","source":{"compiledSource":"var n=Object.defineProperty,s=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;var i=(e,t,p)=\u003et in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:p}):e[t]=p,r=(e,t)=\u003e{for(var p in t||(t={}))h.call(t,p)\u0026\u0026i(e,p,t[p]);if(o)for(var p of o(t))m.call(t,p)\u0026\u0026i(e,p,t[p]);return e},l=(e,t)=\u003es(e,u(t));var c=(e,t)=\u003e{var p={};for(var a in e)h.call(e,a)\u0026\u0026t.indexOf(a)\u003c0\u0026\u0026(p[a]=e[a]);if(e!=null\u0026\u0026o)for(var a of o(e))t.indexOf(a)\u003c0\u0026\u0026m.call(e,a)\u0026\u0026(p[a]=e[a]);return p};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(p){var a=p,{components:e}=a,t=c(a,[\"components\"]);return mdx(MDXLayout,l(r(r({},layoutProps),t),{components:e,mdxType:\"MDXLayout\"}),mdx(\"h2\",null,\"\\u4F5C\\u3063\\u305F\\u3082\\u306E\"),mdx(\"p\",null,mdx(\"a\",r({parentName:\"p\"},{href:\"https://github.com/mijime/markdown-editor\"}),\"https://github.com/mijime/markdown-editor\")),mdx(\"p\",null,\"\\u30C0\\u30A6\\u30F3\\u30ED\\u30FC\\u30C9\\u3059\\u308C\\u3070\\u30AA\\u30D5\\u30E9\\u30A4\\u30F3\\u3067\\u3082\\u4F7F\\u3048\\u308B\\u30DE\\u30FC\\u30AF\\u30C0\\u30A6\\u30F3\\u30A8\\u30C7\\u30A3\\u30BF\\u3092\\u4F5C\\u308A\\u305F\\u304B\\u3063\\u305F\"),mdx(\"hr\",null),mdx(\"h2\",null,\"\\u4F7F\\u3063\\u3066\\u3088\\u304B\\u3063\\u305F\\u3082\\u306E\"),mdx(\"h2\",null,\"Rehype, Remark\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",r({parentName:\"li\"},{href:\"https://github.com/wooorm/rehype\"}),\"https://github.com/wooorm/rehype\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",r({parentName:\"li\"},{href:\"https://github.com/wooorm/remark\"}),\"https://github.com/wooorm/remark\"))),mdx(\"p\",null,\"HTML \\u3084 Markdown \\u3092 AST \\u306B\\u5909\\u63DB\\u3057\\u3066\\u304F\\u308C\\u308B\\u3002\"),mdx(\"p\",null,`Marked \\u304C String \\u3092\\u65E2\\u306B\\u304C\\u3063\\u3061\\u3083\\u3093\\u3053\\u72B6\\u614B\\u3067\\u6295\\u3052\\u3066\\u304F\\u308B\\u306E\\u3067\ndangerouslySetInnerHTML \\u3092\\u4F7F\\u308F\\u3056\\u308B\\u3048\\u306A\\u3044\\u5F71\\u97FF\\u304C\\u51FA\\u3066\\u304F\\u308B\\u3002`),mdx(\"p\",null,\"\\u305D\\u3046\\u3044\\u3046\\u3068\\u304D\\u306F\\u4E0A\\u306E Rehype, Remark \\u3067 AST \\u306B\\u5909\\u63DB\\u3057\\u3066\\u304B\\u3089 React \\u30B3\\u30F3\\u30DD\\u30FC\\u30CD\\u30F3\\u30C8\\u306B\\u3059\\u308B\\u30A2\\u30D7\\u30ED\\u30FC\\u30C1\\u304C\\u826F\\u3055\\u3052\\u3002\"),mdx(\"p\",null,`react-markdown \\u3066\\u3044\\u3046\\u306E\\u3082\\u3042\\u3063\\u305F\\u3051\\u3069 commonmark \\u306B\\u6E96\\u62E0\\u3057\\u3066\\u308B\\u3089\\u3057\\u304F\\u3001\\u30C6\\u30FC\\u30D6\\u30EB\\u306E\\u5909\\u63DB\\u304C\\u3067\\u304D\\u306A\\u304B\\u3063\\u305F\\u306E\\u3067\\u8AE6\\u3081\\u305F\\u3002\n\\u3042\\u3068 commonmark \\u304C\\u5272\\u3068\\u5BB9\\u91CF\\u98DF\\u3063\\u3066\\u305F\\u306E\\u3082\\u3042\\u308B\\u3002`),mdx(\"p\",null,`remark-react \\u3092\\u4F7F\\u308F\\u306A\\u304B\\u3063\\u305F\\u306E\\u306F highlight \\u7CFB\\u306E\\u30E9\\u30A4\\u30D6\\u30E9\\u30EA\\u3092\\u304B\\u307E\\u3059\\u5FC5\\u8981\\u304C\\u3042\\u3063\\u305F\\u306E\\u3068\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"markdown -\u003e html -\u003e react\"),` \\u306E\\u6D41\\u308C\\u306E\\u307B\\u3046\\u304C\\u62E1\\u5F35\\u3057\\u3084\\u3059\\u304F\\u611F\\u3058\\u305F\\u3002\n\\u7D75\\u6587\\u5B57\\u5BFE\\u5FDC\\u3082\\u3055\\u304F\\u3063\\u3068\\u3044\\u3051\\u305F\\u3057\\u3002`),mdx(\"p\",null,\"\\u306A\\u3093\\u304B\\u3084\\u308B\\u3068\\u304D\\u3001\\u3082\\u3057\\u304F\\u306F\\u30C7\\u30F3\\u30B8\\u30E3\\u30E9\\u30B9\\u306A\\u30B3\\u30FC\\u30C9\\u3092\\u5F37\\u8981\\u3055\\u308C\\u305F\\u3068\\u304D\\u306F\\u307E\\u305F\\u4F7F\\u3063\\u3066\\u307F\\u305F\\u3044\\u3002\"),mdx(\"p\",null,\"\\u305F\\u3060\\u3001 marked \\u306E\\u65B9\\u304C\\u8EFD\\u91CF\\u3067\\u306F\\u3042\\u3063\\u305F\\u306E\\u3067\\u30011 \\u56DE\\u304D\\u308A\\u306E\\u8868\\u793A\\u306A\\u3089 marked \\u306E\\u307B\\u3046\\u304C\\u65AD\\u7136\\u826F\\u3055\\u305D\\u3046\\u3002\"),mdx(\"h2\",null,\"Prism.js\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",r({parentName:\"li\"},{href:\"http://prismjs.com/\"}),\"http://prismjs.com/\"))),mdx(\"p\",null,\"highlight.js \\u3092 Minify \\u3059\\u308B\\u3068\\u4E2D\\u8EAB\\u304C\\u98DB\\u3073\\u3067\\u3066\\u8F9B\\u3044\\u3068\\u304D\\u306B\\u4F7F\\u3063\\u305F\\u3084\\u3064\\u3002\"),mdx(\"p\",null,\"\\u30D7\\u30ED\\u30BB\\u30C3\\u30B5\\u3082\\u5206\\u304B\\u308C\\u3066\\u308B\\u306E\\u3067\\u305D\\u306E\\u307E\\u307E rehype \\u306B\\u6D41\\u305B\\u305F\\u3002\"),mdx(\"p\",null,\"\\u30D7\\u30E9\\u30C3\\u30AC\\u30D6\\u30EB\\u3067\\u306A\\u304B\\u306A\\u304B\\u306B\\u8EFD\\u91CF\\u306A\\u306E\\u3067\\u3001\\u304A\\u3059\\u3059\\u3081\\u3057\\u3066\\u3044\\u304D\\u305F\\u3044\\u3002\"),mdx(\"h2\",null,\"Preact\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",r({parentName:\"li\"},{href:\"https://preactjs.com/\"}),\"https://preactjs.com/\"))),mdx(\"p\",null,\"React \\u304C\\u3067\\u304B\\u3059\\u304E\\u305F\\u306E\\u3067\\u4F7F\\u3063\\u3066\\u898B\\u305F\\u3002\"),mdx(\"p\",null,\"webpack-bundle-size-anlyzer \\u3092\\u3064\\u304B\\u3063\\u3066\\u30B5\\u30A4\\u30BA\\u3092\\u6BD4\\u8F03\\u3057\\u305F\\u3002\"),mdx(\"p\",null,\"ReactDOM + React \\u304C 500+kb \\u306A\\u306E\\u306B\\u5BFE\\u3057\\u3001 Preact + Preact-compat \\u304C 35kb \\u524D\\u5F8C\\uFF1F\\u826F\\u3044\\u3002\"),mdx(\"p\",null,`React-Redux \\u306F\\u666E\\u901A\\u306B\\u4F7F\\u3048\\u305F\\u306E\\u3067\\u3001 \\u554F\\u984C\\u306F\\u306A\\u304B\\u3063\\u305F\\u3002 React-helmet \\u3068\\u304B React-router \\u5468\\u308A\\u306F\\u307E\\u3060\\u8A66\\u3057\\u3066\\u3044\\u306A\\u3044\\u3002\n\\u305F\\u3060\\u3001Preact-helmet \\u3084 Preact-router \\u3068\\u304B\\u3042\\u308B\\u3057\\u3001\\u306A\\u3093\\u3060\\u304B\\u3093\\u3060\\u3067\\u307E\\u305F\\u4F7F\\u3048\\u305D\\u3046\\u3002`),mdx(\"p\",null,\"dio.js \\u3068\\u304B\\u3082\\u540C\\u69D8\\u3082\\u7C21\\u5358\\u306B\\u4E57\\u308A\\u63DB\\u3048\\u3089\\u308C\\u308B\\u304B\\u8A66\\u3057\\u305F\\u3051\\u3069\\u3001 Preact-compat \\u306F\\u3060\\u3044\\u3076\\u9811\\u5F35\\u3063\\u3066\\u3044\\u308B\\u306E\\u304C\\u5206\\u304B\\u3063\\u305F\\u3060\\u3051\\u3060\\u3063\\u305F\\u3002\"),mdx(\"p\",null,\"Jest \\u3084 StyleGuidist \\u306A\\u3093\\u304B\\u304C React \\u3092\\u5F37\\u8981\\u3059\\u308B\\u306E\\u3067\\u3001 Webpack \\u3067\\u30D3\\u30EB\\u30C9\\u6642\\u306E\\u307F\\u5DEE\\u3057\\u66FF\\u3048\\u308B\\u904B\\u7528\\u306B\\u3057\\u305F\\u3002\"),mdx(\"h2\",null,\"milligram\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",r({parentName:\"li\"},{href:\"https://milligram.github.io/\"}),\"https://milligram.github.io/\"))),mdx(\"p\",null,`\\u30DE\\u30FC\\u30AF\\u30C0\\u30A6\\u30F3\\u30D7\\u30EC\\u30D3\\u30E5\\u30FC\\u3068\\u3057\\u3066\\u306F\\u7DBA\\u9E97\\u306B\\u8868\\u793A\\u3067\\u304D\\u308B\\u306E\\u3067\\u3001\n\\u307F\\u3093\\u306A Github.css \\u304B\\u3089\\u4E57\\u308A\\u63DB\\u3048\\u308B\\u3079\\u304D\\u3060\\u3068\\u601D\\u3046\\u3002\\u8EFD\\u91CF\\u3067\\u3059\\u3057\\u3002`),mdx(\"p\",null,`\\u305F\\u3060\\u3001\\u30B7\\u30F3\\u30D7\\u30EB\\u306A\\u30B3\\u30F3\\u30DD\\u30FC\\u30CD\\u30F3\\u30C8\\u3057\\u304B\\u306A\\u3044\\u306E\\u3067\nUI \\u304C\\u8907\\u96D1\\u306B\\u306A\\u3063\\u3066\\u304D\\u305F\\u306A\\u3089 Material \\u306A\\u3093\\u3061\\u3083\\u3089\\u7CFB\\u306E\\u65B9\\u304C\\u826F\\u3055\\u305D\\u3046\\u3001\\u3068\\u306F\\u601D\\u3046`),mdx(\"hr\",null),mdx(\"h2\",null,\"\\u898B\\u9001\\u3063\\u305F\\u3082\\u306E\"),mdx(\"h2\",null,\"highlight.js\"),mdx(\"p\",null,`\\u307F\\u3093\\u306A\\u8A00\\u8A9E\\u7D5E\\u3063\\u3066\\u4F7F\\u3063\\u3066\\u308B\\u304F\\u3055\\u3044\\u3002\\u6700\\u521D\\u3001\\u4F55\\u5EA6\\u5727\\u7E2E\\u3057\\u3066\\u3082\\u30AF\\u30BD\\u3067\\u304B\\u304F\\u3066\\u4E0D\\u601D\\u8B70\\u3060\\u3063\\u305F\\u3002\n\\u8A00\\u8A9E\\u306B\\u3088\\u3063\\u3066\\u306F\\u5727\\u7E2E\\u6642\\u306B\\u98DB\\u3073\\u51FA\\u308B\\u3002 \\u3068\\u601D\\u3063\\u305F\\u3051\\u3069 browserify \\u4F7F\\u3063\\u305F\\u6642\\u306F\\u554F\\u984C\\u306A\\u3055\\u305D\\u3046\\u3002. \\u3060\\u3063\\u305F\\uFF1F`),mdx(\"p\",null,\"\\u4F7F\\u3046\\u306E\\u3084\\u3081\\u305F\\u3002\"),mdx(\"h2\",null,\"CodeMirror\"),mdx(\"p\",null,\"\\u91CD\\u91CF\\u304C\\u306A\\u304B\\u306A\\u304B\\u3042\\u3063\\u305F\\u306E\\u3067\\u3001\\u63A1\\u7528\\u3092\\u898B\\u9001\\u3063\\u305F\\u3002 vim mode \\u8A66\\u3057\\u305F\\u304B\\u3063\\u305F\\u3002\"),mdx(\"p\",null,\"\\u3082\\u3063\\u3068\\u8EFD\\u91CF\\u306A\\u30A8\\u30C7\\u30A3\\u30BF\\u304C\\u3042\\u308C\\u3070\\u9078\\u629E\\u80A2\\u306B\\u5165\\u308C\\u305F\\u304B\\u3063\\u305F\\u306E\\u3067\\u3001\\u3042\\u3068\\u3067\\u63A2\\u3059\\u3002\"),mdx(\"hr\",null),mdx(\"h2\",null,\"React.setState\"),mdx(\"p\",null,\"React \\u306E setState \\u306F\\u4F7F\\u308F\\u305A\\u306B pure component \\u3060\\u3051\\u3067\\u69CB\\u6210\\u3057\\u305F\\u304B\\u3063\\u305F\\u306E\\u3067\\u3002\"),mdx(\"p\",null,\"\\u975E\\u540C\\u671F\\u306B\\u63CF\\u753B\\u3057\\u3066\\u30B3\\u30F3\\u30DD\\u30FC\\u30CD\\u30F3\\u30C8\\u5185\\u3060\\u3051\\u3067\\u5B8C\\u7D50\\u3059\\u308B\\u306A\\u3089\\u3001 state \\u3092\\u4F7F\\u3063\\u3066\\u66F8\\u3044\\u305F\\u65B9\\u304C\\u5207\\u308A\\u51FA\\u3057\\u3084\\u3059\\u304B\\u3063\\u305F\\u3002\"),mdx(\"h2\",null,\"Flow\"),mdx(\"p\",null,`\\u4ECA\\u56DE\\u306F\\u9811\\u5F35\\u3063\\u3066 Flowtype \\u306B\\u7ACB\\u3061\\u5411\\u304B\\u3063\\u3066\\u307F\\u305F\\u3002 Flow-jsdoc \\u3067 JSDoc \\u3068\\u540C\\u671F\\u3092\\u3068\\u308A\\u3064\\u3064\\u3001\\u307F\\u305F\\u3044\\u306A\\u3053\\u3068\\u3092\\u5B9F\\u73FE\\u3057\\u305F\\u304B\\u3063\\u305F\\u304C\\u3001\ntype \\u5468\\u308A\\u304C\\u5BFE\\u5FDC\\u3057\\u3066\\u306A\\u304B\\u3063\\u305F\\u306E\\u3067\\u7D50\\u5C40 flow-comment \\u3092\\u3061\\u308A\\u3070\\u3081\\u306A\\u304C\\u3089\\u66F8\\u304F\\u306F\\u3081\\u306B\\u306A\\u3063\\u305F\\u3002`),mdx(\"p\",null,`\\u3042\\u3068\\u3001flow \\u3055\\u3093\\u3063\\u3066 commonjs \\u30B9\\u30BF\\u30A4\\u30EB\\u8AAD\\u307F\\u53D6\\u3063\\u3066\\u304F\\u308C\\u306A\\u3044\\u306E\\u304C\\u4E00\\u756A\\u306E\\u30B7\\u30E7\\u30C3\\u30AF\\u3060\\u3063\\u305F\\u3002\n\\u305D\\u306E\\u4ED6\\u306B\\u3082\\u3001\\u4ED6\\u306E\\u30E9\\u30A4\\u30D6\\u30E9\\u30EA\\u306E `,\"*\",\".flow \\u306B\\u30D3\\u30F3\\u30D3\\u30F3\\u53CD\\u5FDC\\u3057\\u3066\\u3044\\u304F\\u306E\\u3082\\u3061\\u3087\\u3044\\u3061\\u3087\\u3044\\u8F9B\\u3044\\u3002\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"post":{"title":"ReactでMarkdownEditorを作ったかんそう","description":"\n## 作ったもの\n\nhttps://github.com/mijime/markdown-editor\n\nダウンロードすればオフラインでも使えるマークダウンエディタを作りたかった\n\n---\n\n## ","createdAt":"2017-04-09T13:40:10.000Z","tags":["development","react"],"draft":false,"slug":"2017/04/09/thoughts-on-react","content":"\n## 作ったもの\n\nhttps://github.com/mijime/markdown-editor\n\nダウンロードすればオフラインでも使えるマークダウンエディタを作りたかった\n\n---\n\n## 使ってよかったもの\n\n## Rehype, Remark\n\n- https://github.com/wooorm/rehype\n- https://github.com/wooorm/remark\n\nHTML や Markdown を AST に変換してくれる。\n\nMarked が String を既にがっちゃんこ状態で投げてくるので\ndangerouslySetInnerHTML を使わざるえない影響が出てくる。\n\nそういうときは上の Rehype, Remark で AST に変換してから React コンポーネントにするアプローチが良さげ。\n\nreact-markdown ていうのもあったけど commonmark に準拠してるらしく、テーブルの変換ができなかったので諦めた。\nあと commonmark が割と容量食ってたのもある。\n\nremark-react を使わなかったのは highlight 系のライブラリをかます必要があったのと\n`markdown -\u003e html -\u003e react` の流れのほうが拡張しやすく感じた。\n絵文字対応もさくっといけたし。\n\nなんかやるとき、もしくはデンジャラスなコードを強要されたときはまた使ってみたい。\n\nただ、 marked の方が軽量ではあったので、1 回きりの表示なら marked のほうが断然良さそう。\n\n## Prism.js\n\n- http://prismjs.com/\n\nhighlight.js を Minify すると中身が飛びでて辛いときに使ったやつ。\n\nプロセッサも分かれてるのでそのまま rehype に流せた。\n\nプラッガブルでなかなかに軽量なので、おすすめしていきたい。\n\n## Preact\n\n- https://preactjs.com/\n\nReact がでかすぎたので使って見た。\n\nwebpack-bundle-size-anlyzer をつかってサイズを比較した。\n\nReactDOM + React が 500+kb なのに対し、 Preact + Preact-compat が 35kb 前後？良い。\n\nReact-Redux は普通に使えたので、 問題はなかった。 React-helmet とか React-router 周りはまだ試していない。\nただ、Preact-helmet や Preact-router とかあるし、なんだかんだでまた使えそう。\n\ndio.js とかも同様も簡単に乗り換えられるか試したけど、 Preact-compat はだいぶ頑張っているのが分かっただけだった。\n\nJest や StyleGuidist なんかが React を強要するので、 Webpack でビルド時のみ差し替える運用にした。\n\n## milligram\n\n- https://milligram.github.io/\n\nマークダウンプレビューとしては綺麗に表示できるので、\nみんな Github.css から乗り換えるべきだと思う。軽量ですし。\n\nただ、シンプルなコンポーネントしかないので\nUI が複雑になってきたなら Material なんちゃら系の方が良さそう、とは思う\n\n---\n\n## 見送ったもの\n\n## highlight.js\n\nみんな言語絞って使ってるくさい。最初、何度圧縮してもクソでかくて不思議だった。\n言語によっては圧縮時に飛び出る。 と思ったけど browserify 使った時は問題なさそう。. だった？\n\n使うのやめた。\n\n## CodeMirror\n\n重量がなかなかあったので、採用を見送った。 vim mode 試したかった。\n\nもっと軽量なエディタがあれば選択肢に入れたかったので、あとで探す。\n\n---\n\n## React.setState\n\nReact の setState は使わずに pure component だけで構成したかったので。\n\n非同期に描画してコンポーネント内だけで完結するなら、 state を使って書いた方が切り出しやすかった。\n\n## Flow\n\n今回は頑張って Flowtype に立ち向かってみた。 Flow-jsdoc で JSDoc と同期をとりつつ、みたいなことを実現したかったが、\ntype 周りが対応してなかったので結局 flow-comment をちりばめながら書くはめになった。\n\nあと、flow さんって commonjs スタイル読み取ってくれないのが一番のショックだった。\nその他にも、他のライブラリの \\*.flow にビンビン反応していくのもちょいちょい辛い。\n"}},"__N_SSG":true},"page":"/post/[...paths]","query":{"paths":["2017","04","09","thoughts-on-react"]},"buildId":"AnNfzTuH3AQR6W_HWvg1c","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>